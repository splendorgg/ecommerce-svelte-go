<script>
    import {
        Card,
        GradientButton,
        Rating,
        Badge,
        Button,
        Modal,
    } from "flowbite-svelte";
    export let description, image, price, rating, onsale;
    import { count } from "./stores.js";
    let defaultModal = false;
    function incrementCart() {
        count.update((n) => n + 1);
    }

    function shareTwitter() {
        const encoded = encodeURI(
            description +
                " " +
                price.toLocaleString("tr-TR", {
                    style: "currency",
                    currency: "TRY",
                    maximumFractionDigits: 0,
                }),
        );
        return "http://twitter.com/share?text=" + encoded;
    }
    function sharePinterest() {
        const encoded = encodeURI(image);
        return "https://www.pinterest.com/pin/create/button/?media=" + encoded;
    }
    function shareWhatsapp() {
        const encoded = encodeURI(description + " " + price);
        return "https://web.whatsapp.com/send?text=" + encoded;
    }
</script>

<Card padding="none" size="sm" class="productcard">
    <div class="cardimage">
        <img class="p-8 rounded-t-lg" src={image} alt="product 1" />
    </div>

    <div class="px-5 pb-5">
        <h5
            class="text-base sm:text-xl font-semibold tracking-tight text-gray-900 dark:text-white"
        >
            {description}
        </h5>

        <Rating {rating} size="24" class="mt-2.5 mb-5">
            <Badge slot="text" class="ms-3">4</Badge>
        </Rating>
        <div class="flex justify-between items-center">
            <span
                class="text-base sm:text-2xl font-bold text-gray-900 dark:text-white"
                >{price.toLocaleString("tr-TR", {
                    style: "currency",
                    currency: "TRY",
                    maximumFractionDigits: 0,
                })}</span
            >
        </div>
        <GradientButton
            outline
            color="purpleToPink"
            class="buynowbutton"
            on:click={incrementCart}>Buy now</GradientButton
        >
    </div>
    <div on:click={() => (defaultModal = true)} class="sharebutton">
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            class="share"
            ><path
                d="M5 9c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3zm0-2c-2.762 0-5 2.239-5 5s2.238 5 5 5 5-2.239 5-5-2.238-5-5-5zm15 9c-1.165 0-2.204.506-2.935 1.301l-5.488-2.927c-.23.636-.549 1.229-.944 1.764l5.488 2.927c-.072.301-.121.611-.121.935 0 2.209 1.791 4 4 4s4-1.791 4-4-1.791-4-4-4zm0 6c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2zm0-22c-2.209 0-4 1.791-4 4 0 .324.049.634.121.935l-5.488 2.927c.395.536.713 1.128.944 1.764l5.488-2.927c.731.795 1.77 1.301 2.935 1.301 2.209 0 4-1.791 4-4s-1.791-4-4-4zm0 6c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2z"
            />
        </svg>
    </div>

    <Modal title="Share" bind:open={defaultModal} autoclose size="xs">
        <div class="sharebuttons">
            <a href={shareWhatsapp()} target="_blank"
                ><svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="#25D366"
                    ><path
                        d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                    /></svg
                ></a
            >
            <a href={shareTwitter()} target="_blank"
                ><svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="#1DA1F2"
                    ><path
                        d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"
                    /></svg
                ></a
            >
            <a href={sharePinterest()} target="_blank"
                ><svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="#E60023"
                    ><path
                        d="M12 0c-6.627 0-12 5.372-12 12 0 5.084 3.163 9.426 7.627 11.174-.105-.949-.2-2.405.042-3.441.218-.937 1.407-5.965 1.407-5.965s-.359-.719-.359-1.782c0-1.668.967-2.914 2.171-2.914 1.023 0 1.518.769 1.518 1.69 0 1.029-.655 2.568-.994 3.995-.283 1.194.599 2.169 1.777 2.169 2.133 0 3.772-2.249 3.772-5.495 0-2.873-2.064-4.882-5.012-4.882-3.414 0-5.418 2.561-5.418 5.207 0 1.031.397 2.138.893 2.738.098.119.112.224.083.345l-.333 1.36c-.053.22-.174.267-.402.161-1.499-.698-2.436-2.889-2.436-4.649 0-3.785 2.75-7.262 7.929-7.262 4.163 0 7.398 2.967 7.398 6.931 0 4.136-2.607 7.464-6.227 7.464-1.216 0-2.359-.631-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146 1.124.347 2.317.535 3.554.535 6.627 0 12-5.373 12-12 0-6.628-5.373-12-12-12z"
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                    /></svg
                ></a
            >
        </div>
    </Modal>
    {#if onsale}
        <svg
            height="75px"
            width="75px"
            version="1.1"
            class="newsvg"
            id="Layer_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 488.8 488.8"
            xml:space="preserve"
            fill="#000000"
            ><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g
                id="SVGRepo_tracerCarrier"
                stroke-linecap="round"
                stroke-linejoin="round"
            ></g><g id="SVGRepo_iconCarrier">
                <path
                    style="fill:#FF7300;"
                    d="M488,220.8c0-7.2-4.8-13.6-12-15.2l-44.8-11.2l33.6-32c4.8-4.8,6.4-12.8,2.4-19.2l-24-40.8 c-3.2-6.4-11.2-8.8-17.6-7.2L380.8,108l12.8-44.8c1.6-7.2-0.8-14.4-7.2-17.6l-40.8-24c-6.4-3.2-14.4-2.4-19.2,2.4l-32,33.6 l-11.2-44.8c-1.6-7.2-8-12-15.2-12h-48c-7.2,0-13.6,4.8-15.2,12l-11.2,44.8l-32-33.6c-4.8-4.8-12.8-6.4-19.2-2.4l-40.8,24 c-6.4,3.2-8.8,11.2-7.2,17.6l12.8,44.8L62.4,95.2c-7.2-1.6-14.4,0.8-17.6,7.2l-24,40.8c-3.2,6.4-2.4,14.4,2.4,19.2l33.6,32L12,205.6 c-7.2,1.6-12,8-12,15.2V268c0,7.2,4.8,13.6,12,15.2l44.8,11.2l-33.6,32c-4.8,4.8-6.4,12.8-2.4,19.2l24,40.8 c3.2,6.4,11.2,8.8,17.6,7.2l44.8-12.8l-12.8,44.8c-1.6,7.2,0.8,14.4,7.2,17.6l40.8,24c6.4,3.2,14.4,2.4,19.2-2.4l32-33.6l11.2,44.8 c1.6,7.2,8,12,15.2,12h48c7.2,0,13.6-4.8,15.2-12l11.2-44.8l32,33.6c4.8,4.8,12.8,6.4,19.2,2.4l40.8-24c6.4-3.2,8.8-11.2,7.2-17.6 l-12.8-44.8l44.8,12.8c7.2,1.6,14.4-0.8,17.6-7.2l24-40.8c3.2-6.4,2.4-14.4-2.4-19.2l-33.6-32l44.8-11.2c7.2-1.6,12-8,12-15.2 L488,220.8z"
                ></path>
                <g>
                    <path
                        style="fill:#FF3C00;"
                        d="M107.2,108L107.2,108l274.4,274.4l0,0l44.8,12.8c7.2,1.6,14.4-0.8,17.6-7.2l24-40.8 c3.2-6.4,2.4-14.4-2.4-19.2L432,296l44.8-11.2c7.2-1.6,12-8,12-15.2v-47.2c0-7.2-4.8-13.6-12-15.2L432,196l33.6-32 c4.8-4.8,6.4-12.8,2.4-19.2L444,104c-3.2-6.4-11.2-8.8-17.6-7.2l-44.8,12.8l12.8-44.8c1.6-7.2-0.8-14.4-7.2-17.6l-40.8-24 c-6.4-3.2-14.4-2.4-19.2,2.4l-32,33.6l-12-46.4c-1.6-7.2-8-12-15.2-12h-48c-7.2,0-13.6,4.8-15.2,12l-11.2,44.8l-32-33.6 c-4.8-4.8-12.8-6.4-19.2-2.4l-40.8,24c-6.4,3.2-8.8,11.2-7.2,17.6L107.2,108z"
                    ></path>
                    <path
                        style="fill:#FF3C00;"
                        d="M180,296l-53.6-94.4l-17.6,103.2l173.6,173.6c0-0.8,0-0.8,0.8-1.6l11.2-44.8l32,33.6 c4.8,4.8,12.8,6.4,19.2,2.4l40.8-24c6.4-3.2,8.8-11.2,7.2-17.6l-12.8-44.8l44.8,12.8c6.4,1.6,13.6-0.8,17.6-7.2L224.8,198.4 L180,296z"
                    ></path>
                </g>
                <g>
                    <path
                        style="fill:#FFFFFF;"
                        d="M179.2,197.6h-12c-1.6,0-3.2,1.6-3.2,3.2v40c0,8.8,0,16.8,0.8,24.8c-3.2-5.6-6.4-12-10.4-18.4 l-31.2-48.8c-0.8-0.8-1.6-1.6-2.4-1.6h-13.6c-1.6,0-3.2,1.6-3.2,3.2v96.8c0,1.6,1.6,3.2,3.2,3.2h12c1.6,0,3.2-1.6,3.2-3.2v-41.6 c0-10.4,0-18.4,0-25.6c3.2,6.4,7.2,12.8,12,20l30.4,48.8c0.8,0.8,1.6,1.6,2.4,1.6H180c1.6,0,3.2-1.6,3.2-3.2v-96 C182.4,199.2,180.8,197.6,179.2,197.6z"
                    ></path>
                    <path
                        style="fill:#FFFFFF;"
                        d="M255.2,283.2h-38.4v-28h34.4c1.6,0,3.2-1.6,3.2-3.2v-10.4c0-1.6-1.6-3.2-3.2-3.2h-34.4v-24h36 c1.6,0,3.2-1.6,3.2-3.2v-10.4c0-1.6-1.6-3.2-3.2-3.2h-52c-1.6,0-3.2,1.6-3.2,3.2v96.8c0,1.6,1.6,3.2,3.2,3.2h54.4 c1.6,0,3.2-1.6,3.2-3.2v-10.4C258.4,284.8,256.8,283.2,255.2,283.2z"
                    ></path>
                    <path
                        style="fill:#FFFFFF;"
                        d="M384,198.4c-0.8-0.8-1.6-1.6-2.4-1.6h-12.8c-1.6,0-2.4,0.8-3.2,2.4L352.8,248v1.6 c-1.6,5.6-3.2,11.2-4,16.8c-0.8-5.6-2.4-11.2-4-17.6l-12-48.8c0-1.6-1.6-2.4-3.2-2.4h-12.8c-1.6,0-2.4,0.8-3.2,2.4l-12.8,48.8 c-1.6,6.4-3.2,12.8-4.8,18.4c-1.6-5.6-2.4-12-4-18.4L280.8,200c0-1.6-1.6-2.4-3.2-2.4h-12.8c-0.8,0-1.6,0.8-2.4,1.6 s-0.8,1.6-0.8,2.4l24.8,96.8c0,1.6,1.6,2.4,3.2,2.4h12.8c1.6,0,2.4-0.8,3.2-2.4l13.6-50.4c1.6-5.6,3.2-10.4,4-16 c0.8,4.8,2.4,9.6,3.2,16l12,50.4c0,1.6,1.6,2.4,3.2,2.4h12.8c1.6,0,2.4-0.8,3.2-2.4l27.2-96.8C384.8,200.8,384.8,199.2,384,198.4z"
                    ></path>
                </g>
            </g></svg
        >
    {/if}
</Card>
